import streamlit as st
import yaml


# 설정 파일 로드
def load_config():
    with open("config.yaml", "r") as file:
        return yaml.safe_load(file)


config = load_config()

st.set_page_config(page_title="스쿼시 토너먼트 관리 앱", page_icon="🏆", layout="wide")

# 세션 상태 초기화
if "admin_mode" not in st.session_state:
    st.session_state.admin_mode = False

# 사이드바에 관리자 모드 컨트롤 추가
with st.sidebar:
    st.title("관리자 모드")
    if not st.session_state.admin_mode:
        password = st.text_input("관리자 비밀번호", type="password")
        if st.button("관리자 모드 활성화"):
            if password == config["admin_password"]:
                st.session_state.admin_mode = True
                st.success("관리자 모드가 활성화되었습니다.")
                st.rerun()
            else:
                st.error("비밀번호가 올바르지 않습니다.")
    else:
        st.success("관리자 모드 활성화 상태")
        if st.button("관리자 모드 비활성화"):
            st.session_state.admin_mode = False
            st.rerun()

st.title("스쿼시 토너먼트 관리 앱 🏆")

admin_mode_text = "활성화" if st.session_state.admin_mode else "비활성화"
st.markdown(f"현재 관리자 모드: **{admin_mode_text}**")

tab1, tab2 = st.tabs(["대회 안내", "사용 안내"])
with tab1:
    st.header("제12회 중랑구청장배 및 연맹회장배 스쿼시대회", divider="rainbow")
    st.markdown(
        """
        ### 대회 개요
        - **대회명**: 제12회 중랑구청장배 및 연맹회장배 스쿼시 대회
        - **일시**: 2024년 9월 29일(일요일) 10시 (개회식 10시)
        - **장소**: 중화 스쿼시헬스클럽 (중랑구 중화2동 303-14번지 그린프라자빌딩지하1층)
        - **주최**: 중랑구체육회
        - **주관**: 중랑구 스쿼시연맹
        - **후원**: 중랑구청, 서울시스쿼시연맹

        ### 참가 정보
        - **참가 자격**: 스쿼시 게임 경험 있는 순수 동호인
        - **참가 구분**: 개인전 (남녀 새내기부, 미니엄부, 베타랑부)
        - **참가비**: 30,000원

        ### 경기 방식
        - 1라운드 전경기 랠리포인트 21점 1게임 (경기 운영상 변경 가능)
        - 경기구: 던롭 XX 컴피언쉽 볼

        ### 참가 신청
        - **신청 방법**: [네이버폼](https://naver.me/5k7qGD57)
        - **접수 마감**: 2024년 9월 20일 금요일 12:00
        - **참가비 입금**: 농협 302-0242-2883-11 배금주 / 중랑구연맹(신의균)

        ### 기타 사항
        - 참가 선수 전원 상해보험 가입
        - 경품 추첨 및 고급 기념품 증정
        - 예선 경기 시작 30분 전까지 출전 확인 필수

        ### 문의
        자세한 사항은 중랑구 스쿼시연맹 신의균(010-3709-7525)으로 문의 바랍니다.
        """
    )

with tab2:
    st.header("사용 안내", divider="rainbow")
    st.markdown(
        """
        이 앱은 스쿼시 토너먼트를 효율적으로 관리하기 위해 설계되었습니다. 주요 기능은 다음과 같습니다:

        ### 1. 매치 정보 입력 및 관리 (관리자 모드)
        - **매치 등록**: 라운드, 성별, 매치 타입, 선수 이름을 입력하여 새로운 매치를 등록할 수 있습니다.
        - **정보 수정**: 등록된 매치 정보를 수정할 수 있습니다.
        - **매치 삭제**: 불필요한 매치를 삭제할 수 있습니다.

        ### 2. 결과 입력 (관리자 모드)
        - 각 매치의 결과(점수)를 입력하고 저장할 수 있습니다.

        ### 3. 데이터 확인 및 분석 (모든 사용자)
        - **필터링**: 장소, 코트, 라운드, 성별, 매치 타입, 선수 이름으로 데이터를 필터링할 수 있습니다.
        - **데이터 표시**: 필터링된 데이터를 테이블 형식으로 확인할 수 있습니다.
        - **전체 데이터 확인**: 모든 매치 데이터를 한 눈에 볼 수 있습니다.

        ### 4. 다중 코트 지원
        - 여러 장소와 코트에 대한 정보를 별도로 관리할 수 있습니다.

        ### 5. 실시간 업데이트
        - 데이터 입력 즉시 화면에 반영되며, 필요시 새로고침 기능을 제공합니다.

        ### 사용 방법
        1. 관리자는 좌측 사이드바에서 관리자 모드를 활성화합니다.
        2. 좌측 사이드바에서 원하는 코트 페이지를 선택합니다.
        3. 관리자 모드에서는 매치 정보를 입력하고 관리합니다.
        4. 관리자 모드에서 결과가 나오면 입력합니다.
        5. '정보 확인' 페이지에서 전체 데이터를 확인하고 분석합니다 (모든 사용자 가능).

        이 앱을 통해 토너먼트 운영을 더욱 효율적으로 관리하실 수 있습니다. 
        즐거운 사용 되세요!
        """
    )


st.sidebar.success("위에서 페이지를 선택하세요.")
